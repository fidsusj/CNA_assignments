\section{Problem 2-1 Erdos-Renyi Network}

Consider an Erdos-Renyi network with N = 80 nodes, connected to each other with probability p = 0.05.

\begin{enumerate}
	\item What is (i) the expected number of links in the graph and (ii) the expected degree of a node?
	
	(i) The expected number of links in the graph:
	
	\begin{equation}
	\langle L \rangle = p \frac{N(N-1)}{2} = 0.05 \frac{80 \cdot (80 - 1)}{2} = 158
	\end{equation}
	
	The expected number of links in the graph is 158.
	
	(ii) The expected degree of a node:
	
	\begin{equation}
	\langle k \rangle = p(N-1) = 0.05 \cdot (80 -1) = 3.95
	\end{equation}
	
	The expected degree of a node in the network is 3.95.
	
	\item In which regime is the network?
	
	$\langle k \rangle$ is $3.95$,  thus greater than $1$ and not in the subcritical regime.
	
	$\langle k \rangle < ln(N)$ since $3.95 < 4.38$,  thus it is not in the connected regime.
	
	This means that the network is in the \textbf{supercritical regime}.
	
	\item What is the probability to find exactly $L = 200$ links in the graph?
	
	\begin{equation}
	p_L = {{\frac{N(N-1)}{2}} \choose {L}} p^L (1-p)^{(N(N-1)/2)-L}
	\end{equation}
	
	\begin{equation}
	p_{200} = {{\frac{80(80-1)}{2}} \choose {200}} 0.05^{200} (1-0.05)^{(80(80-1)/2)-200} \approx 1.26e^{-4}
	\end{equation}
	
	The probability to find exactly 200 links in the graph is arround $1.26e^{-4}$.
	
	\item What is the probability that a node $i$ in the graph has degree $k_i = 5$ (using the binomial distribution)?
	
	\begin{equation}
	p_k = {N - 1 \choose k} p^k (1-p)^{N-1-k}
	\end{equation}
	
	\begin{equation}
	p_5 = {80 - 1 \choose 5} 0.05^5 (1-0.05)^{80-1-5} \approx 0.158
	\end{equation}
	
	The probability of a node $i$ having a degree of $5$ is $0.158$.
	
	\item Use maximum likelihood estimation to estimate the model parameters $(N, p)$ for the shown graph.
	
	\begin{table}[]
\centering
\begin{tabular}{ll}
\hline
Node & Degree \\ \hline
1    & 3      \\
2    & 2      \\
3    & 2      \\
4    & 1      \\
5    & 5      \\
6    & 1      \\
7    & 1      \\
8    & 3      \\
9    & 1      \\
10   & 1      \\
11   & 1      \\
12   & 1      \\ \hline
\end{tabular}
\caption{}
\label{tab:node_degrees}
\end{table}

From Table \ref{tab:node_degrees} follows that the average degree of the network is $\langle k \rangle \approx 1.83$.

\begin{equation}
\langle k \rangle = p(N-1)
\end{equation}

\begin{equation}
p = \frac{\langle k \rangle}{N-1} = \frac{1.83}{12-1} \approx 0.166
\end{equation}

The model parameters are $N = 12$ and $p = 0.166$.

	
	
\textbf{Alternative:}
We also tried an alternative approach which should be 'real' maximum likelihood estimation.  This uses the number of edges,  as well as the number of vertices and does not rely on vertex degrees.
$p(G)$ is maximized for 

\begin{equation}
p = \frac{m \cdot 2}{n(n-1)}
\end{equation}
where $m$ is the number of edges and n is the number of vertices in the graph.

\begin{equation}
p = \frac{11 \cdot 2}{12(12-1)} \approx 0.166
\end{equation}

We multiply $m$ with 2,  since indegree = outdegree on this undirected graph.

Following this method,  $p$ would be $0.166$.
	
	
	
\end{enumerate}